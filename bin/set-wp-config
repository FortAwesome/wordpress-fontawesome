#!/bin/bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
source $DIR/.common.bash

$WP_SUDO $DOCKER exec -it -w /var/www/html $WP_CONTAINER grep -P "^define\W+$1\W" wp-config.php > /dev/null;

if [ $? == 0 ]; then
  echo "Found existing setting. Changing..."
  $WP_SUDO $DOCKER exec -it -w /var/www/html $WP_CONTAINER sed -ri "/^define.*?$1.+?(false|true)\);/ s/(false|true)/$2/" wp-config.php
else
  echo "Adding new setting..."
  $WP_SUDO $DOCKER exec -it -w /var/www/html $WP_CONTAINER sed -ri "2idefine(\'$1\', $2);" wp-config.php
fi

echo "Resulting value:"
$WP_SUDO $DOCKER exec -it -w /var/www/html $WP_CONTAINER grep -P "^define\W+$1\W" wp-config.php
